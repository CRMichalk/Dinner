<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Baseball Scoreboard</title>
<style>
body { font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif; margin:0; padding:5px; background:#f0f4f8; display:flex; flex-direction:column; align-items:center; }

.scoreboard { background:#e0f0ff; border-radius:16px; padding:8px; width:100%; max-width:440px; box-shadow:0 4px 10px rgba(0,0,0,0.1); margin-bottom:8px; display:flex; flex-direction:column; align-items:center; }

h1 { margin:0 0 4px 0; font-size:1.1em; color:#333; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

.mini-stats { display:flex; justify-content:space-around; width:100%; margin-bottom:6px; }
.circles { display:flex; gap:3px; }
.circles .circle { width:12px; height:12px; border-radius:50%; border:1px solid #555; background:#ddd; }
.circles .circle.filled { background:#000; }

.clock-container { display:flex; justify-content:space-between; width:100%; font-size:0.85em; margin-bottom:6px; color:#333; }

table.line-score { width:100%; border-collapse:separate; border-spacing:0; border-radius:12px; overflow:hidden; text-align:center; font-size:0.85em; margin-bottom:6px; background:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
table.line-score th, table.line-score td { border-bottom:1px solid #ccc; padding:4px 2px; }
table.line-score th { background:#4a90e2; color:#fff; font-weight:normal; }
table.line-score td.team { font-weight:bold; background:#f0f4f8; position:relative; }
.team-us { font-size:0.75em; color:gold; margin-left:3px; }

.grid { display:grid; grid-template-columns:1fr 1fr; gap:6px; width:100%; max-width:440px; }
.button { background:#4a90e2; color:#fff; border-radius:12px; text-align:center; cursor:pointer; user-select:none; display:flex; flex-direction:column; justify-content:center; align-items:center; height:70px; font-size:1.1em; transition: background 0.15s; box-shadow:0 2px 4px rgba(0,0,0,0.2); }
.button span.label { font-size:0.9em; color:#fff; margin-bottom:4px; }
.button span.value { font-size:1.5em; }
.button.pressed { background:#357ab7; }
.button.disabled { background:#777; cursor:not-allowed; }

button.reset { margin-top:8px; padding:10px 16px; border:none; border-radius:12px; background:#333; color:#fff; font-size:1em; cursor:pointer; width:90%; max-width:440px; }
button.reset:active { background:#555; }

#teamSelectModal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); display:flex; justify-content:center; align-items:center; z-index:100; }
#teamSelectModal div { background:#fff; padding:16px; border-radius:12px; text-align:center; }
#teamSelectModal button { margin:5px; padding:8px 16px; font-size:0.95em; cursor:pointer; background:#4a90e2; color:#fff; border:none; border-radius:8px; }
#teamSelectModal button:hover { background:#357ab7; }

</style>
</head>
<body>

<div class="scoreboard">
  <h1 id="systemDate"></h1>

  <div class="mini-stats">
    <div>B: <div class="circles" id="ballsCircles"></div></div>
    <div>S: <div class="circles" id="strikesCircles"></div></div>
    <div>O: <div class="circles" id="outsCircles"></div></div>
  </div>

  <div class="clock-container">
    <div>Clock: <span id="gameClock">00:00</span></div>
    <div id="startTimestamp"></div>
  </div>

  <table class="line-score">
    <thead>
      <tr id="inningHeader"><th>Team</th></tr>
    </thead>
    <tbody>
      <tr><td class="team" id="awayCell">Away <span class="team-us" id="awayUs" style="display:none;">(Us)</span></td></tr>
      <tr><td class="team" id="homeCell">Home <span class="team-us" id="homeUs" style="display:none;">(Us)</span></td></tr>
    </tbody>
  </table>
</div>

<div class="grid">
  <div class="button" id="ballsBtn"><span class="label">Balls</span><span class="value" id="ballsCount">0</span></div>
  <div class="button" id="awayBtn"><span class="label">Away</span><span class="value">0</span></div>
  <div class="button" id="strikesBtn"><span class="label">Strikes</span><span class="value" id="strikesCount">0</span></div>
  <div class="button" id="homeBtn"><span class="label">Home</span><span class="value">0</span></div>
  <div class="button" id="outsBtn"><span class="label">Outs</span><span class="value" id="outsCount">0</span></div>
  <div class="button" id="inningBtn"><span class="label">Inning</span><span class="value" id="inningNumberDisplay">Top 1</span></div>
</div>

<button class="reset" onclick="resetGame()">Reset Game</button>

<div id="teamSelectModal">
  <div>
    <p>Select your team:</p>
    <button onclick="chooseTeam('away')">Away</button>
    <button onclick="chooseTeam('home')">Home</button>
  </div>
</div>

<script>
let inningNumber=1, inningHalf='Top', balls=0, strikes=0, outs=0;
let team=null;
let runsPerInningAway=[0], runsPerInningHome=[0];
let gameStarted=false, gameStartTime=null, clockInterval=null;

function updateSystemDate(){
  const now=new Date();
  const options={weekday:'long', year:'numeric', month:'long', day:'numeric'};
  document.getElementById('systemDate').textContent=now.toLocaleDateString(undefined,options);
}
updateSystemDate();

function haptic(){ if(navigator.vibrate) navigator.vibrate(50); }

function startGameClock(){
  if(!gameStarted){
    gameStarted=true;
    gameStartTime=new Date();
    document.getElementById('startTimestamp').textContent="Game started: "+gameStartTime.toLocaleTimeString();
    clockInterval=setInterval(()=>{
      const now=new Date();
      const elapsed=Math.floor((now-gameStartTime)/1000);
      const minutes=Math.floor(elapsed/60);
      const seconds=elapsed%60;
      document.getElementById('gameClock').textContent = `${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
    },1000);
  }
}

function chooseTeam(selected){
  team = selected;
  document.getElementById('teamSelectModal').style.display='none';
  document.getElementById('awayUs').style.display=(team==='away')?'inline':'none';
  document.getElementById('homeUs').style.display=(team==='home')?'inline':'none';
  updateDisplay();
}

function updateLineScoreTable(){
  const header=document.getElementById('inningHeader');
  const tbody=document.querySelector('table.line-score tbody');
  const maxInning=Math.max(inningNumber, runsPerInningAway.length, runsPerInningHome.length);
  header.innerHTML='<th>Team</th>';
  for(let i=1;i<=maxInning;i++) header.innerHTML+=`<th>${i}</th>`;
  header.innerHTML+='<th>Total</th>';
  tbody.rows[0].innerHTML=`<td class="team" id="awayCell">Away <span class="team-us" id="awayUs" style="display:${team==='away'?'inline':'none'};">(Us)</span></td>`;
  tbody.rows[1].innerHTML=`<td class="team" id="homeCell">Home <span class="team-us" id="homeUs" style="display:${team==='home'?'inline':'none'};">(Us)</span></td>`;
  let totalAway=0,totalHome=0;
  for(let i=0;i<maxInning;i++){
    const awayRun=runsPerInningAway[i]||0, homeRun=runsPerInningHome[i]||0;
    totalAway+=awayRun; totalHome+=homeRun;
    tbody.rows[0].innerHTML+=`<td>${awayRun}</td>`;
    tbody.rows[1].innerHTML+=`<td>${homeRun}</td>`;
  }
  tbody.rows[0].innerHTML+=`<td>${totalAway}</td>`;
  tbody.rows[1].innerHTML+=`<td>${totalHome}</td>`;
}

function updateCircles(){
  const fillCircles=(num,containerId)=>{
    const container=document.getElementById(containerId);
    container.innerHTML='';
    for(let i=0;i<4;i++){
      const c=document.createElement('div');
      c.className='circle'+(i<num?' filled':'');
      container.appendChild(c);
    }
  };
  fillCircles(balls,'ballsCircles');
  fillCircles(strikes,'strikesCircles');
  fillCircles(outs,'outsCircles');
}

function updateDisplay(){
  document.getElementById('ballsCount').textContent=balls;
  document.getElementById('strikesCount').textContent=strikes;
  document.getElementById('outsCount').textContent=outs;
  document.getElementById('inningNumberDisplay').textContent=`${inningHalf} ${inningNumber}`;

  // Total runs on buttons
  const totalAway=runsPerInningAway.reduce((a,b)=>a+b,0);
  const totalHome=runsPerInningHome.reduce((a,b)=>a+b,0);
  document.querySelector('#awayBtn .value').textContent=totalAway;
  document.querySelector('#homeBtn .value').textContent=totalHome;

  updateCircles();
  updateLineScoreTable();
}

function addBall(){ startGameClock(); balls++; if(balls>=4){ balls=0; strikes=0; addOut(); } updateDisplay(); }
function decrementBall(){ if(balls>0){ balls--; haptic(); updateDisplay(); } }
function addStrike(){ startGameClock(); strikes++; if(strikes>=3){ strikes=0; balls=0; addOut(); } updateDisplay(); }
function decrementStrike(){ if(strikes>0){ strikes--; haptic(); updateDisplay(); } }
function addOut(){ outs++; if(outs>=3){ outs=0; incrementInningHalf(); } balls=strikes=0; updateDisplay(); haptic(); }
function decrementOut(){ if(outs>0){ outs--; haptic(); updateDisplay(); } }

function addRun(teamName){
  const index=inningNumber-1;
  if((inningHalf==='Top' && teamName==='home')||(inningHalf==='Bottom' && teamName==='away')) return;
  if(teamName==='away'){ if(!runsPerInningAway[index]) runsPerInningAway[index]=0; runsPerInningAway[index]++; }
  if(teamName==='home'){ if(!runsPerInningHome[index]) runsPerInningHome[index]=0; runsPerInningHome[index]++; }
  haptic(); updateDisplay();
}
function decrementRun(teamName){
  const index=inningNumber-1;
  if((teamName==='away' && inningHalf==='Bottom')||(teamName==='home' && inningHalf==='Top')) return;
  if(teamName==='away' && runsPerInningAway[index]>0) runsPerInningAway[index]--;
  if(teamName==='home' && runsPerInningHome[index]>0) runsPerInningHome[index]--;
  haptic(); updateDisplay();
}

function incrementInningHalf(){ inningHalf=(inningHalf==='Top')?'Bottom':'Top'; if(inningHalf==='Top') inningNumber++; }
function resetGame(){ balls=strikes=outs=0; inningNumber=1; inningHalf='Top'; runsPerInningAway=[0]; runsPerInningHome=[0]; gameStarted=false; clearInterval(clockInterval); clockInterval=null; document.getElementById('gameClock').textContent="00:00"; document.getElementById('startTimestamp').textContent=''; updateSystemDate(); updateDisplay(); document.getElementById('teamSelectModal').style.display='flex'; }

// Long press helper
function addLongPress(btn, addFunc, decFunc){
  let timer=null; let longPressActive=false;
  const startPress=e=>{ e.preventDefault(); longPressActive=false; timer=setTimeout(()=>{ decFunc(); longPressActive=true; },600); };
  const endPress=e=>{ e.preventDefault(); clearTimeout(timer); if(!longPressActive) addFunc(); };
  btn.addEventListener('mousedown', startPress); btn.addEventListener('mouseup', endPress); btn.addEventListener('mouseleave', e=>clearTimeout(timer));
  btn.addEventListener('touchstart', startPress); btn.addEventListener('touchend', endPress);
}

document.addEventListener('DOMContentLoaded',()=>{
  addLongPress(document.getElementById('ballsBtn'), addBall, decrementBall);
  addLongPress(document.getElementById('strikesBtn'), addStrike, decrementStrike);
  addLongPress(document.getElementById('outsBtn'), addOut, decrementOut);
  addLongPress(document.getElementById('awayBtn'), ()=>addRun('away'), ()=>decrementRun('away'));
  addLongPress(document.getElementById('homeBtn'), ()=>addRun('home'), ()=>decrementRun('home'));
  updateDisplay();
});
</script>
</body>
</html>
